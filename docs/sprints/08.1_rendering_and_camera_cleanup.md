
# Sprint 8.1: Rendering and Camera Cleanup

**Duration**: 2 Days
**Priority**: Medium
**Dependencies**: Sprints 4.2, 7, 7.1

## Sprint Goal
This sprint is dedicated to addressing technical debt and streamlining the rendering and camera systems following the major refactor and implementation work in previous sprints. The goal is to consolidate documentation, clarify the implementation, and ensure the codebase is clean and maintainable.

## Analysis of Previous Sprints

### Sprint 4.2: Rendering Refactor
- **Objective**: Move rendering logic to `render_mesh.c` and implement transform matrices.
- **Outcome**: Successfully refactored, but the integration with the camera system was not yet complete.

### Sprints 7 & 7.1: 3D Camera System
- **Objective**: Implement and finalize a 3D camera system with proper matrix math and ECS integration.
- **Outcome**: A functional camera system was created, but the documentation was spread across two sprints, leading to some confusion. The implementation also has some redundant code and could be further optimized.

## Technical Debt and Cleanup Tasks

### Task 8.1.1: Consolidate Camera and Rendering Documentation
**Estimated**: 0.5 days
**Files**: `docs/guides/development/DEVELOPMENT_GUIDE.md`, `docs/guides/architecture/OVERVIEW.md`

#### Acceptance Criteria
- [ ] Create a single, authoritative document describing the rendering and camera systems.
- [ ] This document should be part of the main `guides`, not in the sprint history.
- [ ] The old sprint documents (4.2, 7, 7.1) should be archived.
- [ ] The `DEVELOPMENT_GUIDE.md` and `OVERVIEW.md` should be updated to link to the new, consolidated document.

### Task 8.1.2: Refactor Camera Matrix Calculations
**Estimated**: 1 day
**Files**: `src/render_camera.c`, `src/render_camera.h`

#### Acceptance Criteria
- [ ] Review the matrix calculation logic in `render_camera.c`.
- [ ] Remove any redundant or unused matrix functions.
- [ ] Ensure that the `dirty` flag mechanism is used efficiently to avoid unnecessary recalculations.
- [ ] Add comments to clarify the matrix math, especially the `lookat` and `perspective` functions.

### Task 8.1.3: Streamline Rendering Loop
**Estimated**: 0.5 days
**Files**: `src/render_mesh.c`, `src/main.c`

#### Acceptance Criteria
- [ ] The main render loop in `main.c` should be as clean as possible, with all rendering logic delegated to the appropriate systems.
- [ ] The `render_mesh_system_update` function should be the single point of entry for all mesh rendering.
- [ ] Ensure that the active camera is fetched only once per frame.

## Definition of Done
- [ ] The documentation for the rendering and camera systems is consolidated and easy to understand.
- [ ] The camera matrix code is clean, efficient, and well-commented.
- [ ] The main rendering loop is streamlined and delegates all work to the appropriate systems.
- [ ] The project is in a clean state, ready for the next phase of development.
