# Sprint 4.1: Sokol Rendering Refinement

**Goal:** Bridge the gap between the CPU-side simulation and the GPU to achieve visual output. This sprint directly addresses the critical deficiencies identified in the Sprint 4 final review.

**Period:** August 2025

## Key Objectives:

This sprint is a direct implementation of the action plan laid out in the "Sokol Migration Engineering Report".

### Phase 1: Foundational Rendering

**Goal**: To get 3D geometry rendering on the screen as quickly as possible.

1.  **[ ] Render a Test Triangle:**
    *   **Action**: Re-enable or re-implement test triangle rendering code in the main render loop.
    *   **Rationale**: Provides an immediate, simple visual confirmation that the core `sokol_gfx` pipeline is working correctly.

2.  **[ ] Create a `Renderable` Component:**
    *   **Action**: Define a new `Renderable` component that will hold GPU-specific resource handles (`sg_buffer` for vertex/index data, `sg_image` for textures).
    *   **Rationale**: Establishes a clear, data-driven link between an entity and its GPU resources.

3.  **[ ] Implement a Simple Mesh Renderer:**
    *   **Action**: Create a system that iterates over entities with `Transform` and `Renderable` components and issues `sg_draw` calls.
    *   **Rationale**: Provides a basic but functional mesh rendering system, making the world visible.

### Phase 2: Asset-to-GPU Pipeline

**Goal**: To fully migrate the asset system to produce GPU-ready resources.

1.  **[ ] Migrate Mesh Data:**
    *   **Action**: Modify the `assets.c` module to create `sg_buffer` objects from the loaded mesh data and store them in the corresponding entity's `Renderable` component.
    *   **Rationale**: Enables the rendering of actual mesh geometry from the asset files.

2.  **[ ] Migrate Texture Data:**
    *   **Action**: Use a library like `stb_image.h` (already in the project) to load texture data from files and create `sg_image` objects. Store them in the `Renderable` component.
    *   **Rationale**: Enables the rendering of textured meshes, bringing the visuals closer to the original state.

### Phase 3: Restore Core Features

**Goal**: To restore critical systems that depend on visual output.

1.  **[ ] Camera System Integration:**
    *   **Action**: Ensure the view and projection matrices from the active `Camera` component are correctly passed to the shaders as uniforms during the render system update.
    *   **Rationale**: Restores full camera control and functionality.

2.  **[ ] UI System Restoration (Initial):**
    *   **Action**: Follow the plan in `docs/engineering/NUKLEAR_INTEGRATION_REPORT.md` to complete the initial UI implementation.
    *   **Rationale**: Restores the debug overlay and provides a foundation for a more advanced UI.

## Expected Outcomes:

*   The application will render 3D meshes and textured models.
*   The asset pipeline will correctly load and prepare resources for the GPU.
*   The camera system will be fully functional.
*   A basic debug UI will be available.
*   The project will no longer be in a "functionally blind" state, unblocking further development and debugging.
